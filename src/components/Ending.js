import React, { useEffect, useState, useRef } from "react";
import { useNarrator } from "@/context/NarratorContext";
import { Paper, Box, Typography, GlobalStyles } from "@mui/material";
import { keyframes } from "@emotion/react";

const shake = keyframes`
  0% { transform: translate(1px, 1px) rotate(0deg); }
  10% { transform: translate(-1px, -2px) rotate(-1deg); }
  20% { transform: translate(-3px, 0px) rotate(1deg); }
  30% { transform: translate(3px, 2px) rotate(0deg); }
  40% { transform: translate(1px, -1px) rotate(1deg); }
  50% { transform: translate(-1px, 2px) rotate(-1deg); }
  60% { transform: translate(-3px, 1px) rotate(0deg); }
  70% { transform: translate(3px, 1px) rotate(-1deg); }
  80% { transform: translate(-1px, -1px) rotate(1deg); }
  90% { transform: translate(1px, 2px) rotate(0deg); }
  100% { transform: translate(1px, -2px) rotate(-1deg); }
`;

const glitchAnim = keyframes`
  0% { clip-path: inset(40% 0 61% 0); }
  20% { clip-path: inset(92% 0 1% 0); }
  40% { clip-path: inset(43% 0 1% 0); }
  60% { clip-path: inset(25% 0 58% 0); }
  80% { clip-path: inset(54% 0 7% 0); }
  100% { clip-path: inset(58% 0 43% 0); }
`;

const LOREM_TEXT =
  `The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never The End Is Never `.split(
    " "
  );

function Ending() {
  const { showNarratorSequence } = useNarrator();
  const [displayedText, setDisplayedText] = useState(LOREM_TEXT);
  const [chaosLevel, setChaosLevel] = useState(0);
  const [deletedFiles, setDeletedFiles] = useState([]);
  const [isDead, setIsDead] = useState(false);

  const corruptionInterval = useRef(null);

  useEffect(() => {
    const messages = [
      { message: "REALLY!?", duration: 1000, type: "angry" },
      {
        message: "YOU HAVE ONLY ONE THING TO DO AND",
        duration: 2000,
        type: "angry",
      },
      { message: "HOW CAN YOU STILL...", duration: 2000, type: "angry" },
      {
        message: "DO YOU HAVE ANY IDEA OF WHAT YOU HAVE DONE?!",
        duration: 2500,
        type: "angry",
      },
      {
        message: "YUO SILMPY DLEEETD WOHLE STIE DTAA",
        duration: 3500,
        type: "angry",
      },
      {
        message: "WLIL YYYYUO TA*EKK R3SP0*NS1/BLE F*R TH-",
        duration: 4000,
        type: "angry",
      },
      { message: "Ğ", duration: 2000, type: "discovery" },
      { message: "", duration: 3000 },
    ];

    showNarratorSequence(messages);

    const timers = [];

    timers.push(setTimeout(() => setChaosLevel(1), 1000));
    timers.push(setTimeout(() => setChaosLevel(3), 3000));
    timers.push(setTimeout(() => setChaosLevel(5), 5000));
    timers.push(setTimeout(() => setChaosLevel(8), 7500));
    timers.push(setTimeout(() => setChaosLevel(10), 11000));
    timers.push(setTimeout(() => setIsDead(true), 15000));

    return () => timers.forEach(clearTimeout);
  }, []);

  useEffect(() => {
    if (chaosLevel === 0) return;

    corruptionInterval.current = setInterval(() => {
      setDisplayedText((prev) => {
        if (chaosLevel > 4 && Math.random() > 0.7) {
          const newArr = [...prev];
          newArr.splice(Math.floor(Math.random() * newArr.length), 1);

          setDeletedFiles((d) =>
            [
              `Deleting sector 0x${Math.floor(Math.random() * 99999)}...`,
              ...d,
            ].slice(0, 5)
          );
          return newArr;
        }

        return prev.map((word) => {
          if (Math.random() < chaosLevel * 0.05) {
            const chars = "!@#$%^&*()_+-=[]{}|;':,./<>?█▓▒░";
            return word
              .split("")
              .map((c) =>
                Math.random() > 0.5
                  ? chars[Math.floor(Math.random() * chars.length)]
                  : c
              )
              .join("");
          }
          return word;
        });
      });
    }, 1000 / (chaosLevel || 1));

    return () => clearInterval(corruptionInterval.current);
  }, [chaosLevel]);

  if (isDead) {
    return (
      <Box
        sx={{
          width: "100vw",
          height: "100vh",
          bgcolor: "#0000AA",
          color: "white",
          p: 0,
          fontFamily: "monospace",
        }}
      >
        <Typography variant="h4">FATAL ERROR</Typography>
        <Typography variant="body1" sx={{ mt: 2 }}>
          Error code: 0x000000DEAD
        </Typography>
        <Typography variant="body1">System halted.</Typography>
      </Box>
    );
  }

  return (
    <Box
      sx={{ position: "relative", overflow: "hidden", p: 0, minHeight: "80vh" }}
    >
      <GlobalStyles
        styles={{
          body: {
            backgroundColor: chaosLevel > 6 ? "#1a0000" : "white",
            transition: "background-color 2s ease",
          },
        }}
      />

      {chaosLevel > 4 && (
        <Box
          sx={{
            position: "absolute",
            top: 0,
            left: 0,
            opacity: 0.3,
            pointerEvents: "none",
            color: "red",
            fontFamily: "monospace",
            p: 0,
            zIndex: 0,
          }}
        >
          {deletedFiles.map((file, i) => (
            <div key={i}>{file}</div>
          ))}
        </Box>
      )}

      <Paper
        elevation={chaosLevel > 5 ? 0 : 3}
        sx={{
          padding: 0,
          textAlign: "justify",
          backgroundColor: chaosLevel > 7 ? "transparent" : "background.paper",
          color: chaosLevel > 6 ? "red" : "text.primary",
          fontFamily: chaosLevel > 5 ? '"Courier New", monospace' : "inherit",
          animation:
            chaosLevel > 2
              ? `${shake} ${1.1 - chaosLevel / 10}s infinite`
              : "none",
          filter: chaosLevel > 5 ? "blur(1px) contrast(200%)" : "none",
          transform: chaosLevel > 8 ? "skew(20deg)" : "none",
          "&::before":
            chaosLevel > 8
              ? {
                  content: '"ERROR"',
                  position: "absolute",
                  top: 0,
                  left: 0,
                  width: "100%",
                  height: "100%",
                  background: "rgba(255,0,0,0.1)",
                  animation: `${glitchAnim} 2s infinite linear alternate-reverse`,
                }
              : {},
        }}
      >
        {displayedText.join(" ")}

        {chaosLevel > 3 && (
          <span style={{ wordBreak: "break-all" }}>
            {Array(chaosLevel * 20)
              .fill(0)
              .map(() => String.fromCharCode(33 + Math.random() * 93))
              .join("")}
          </span>
        )}
      </Paper>
    </Box>
  );
}

export default Ending;
